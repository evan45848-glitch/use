# ==============================
# üîπ FULL WINRM NO-PASSWORD SETUP (TARGET PC)
# ==============================

# 1Ô∏è‚É£ Enable WinRM (if not already enabled)
Enable-PSRemoting -Force

# 2Ô∏è‚É£ Make sure WinRM service is running
Set-Service -Name WinRM -StartupType Automatic
Start-Service WinRM

# 3Ô∏è‚É£ Allow basic authentication
Set-Item WSMan:\localhost\Service\Auth\Basic -Value $true

# 4Ô∏è‚É£ Allow unencrypted traffic (needed for blank passwords)
Set-Item WSMan:\localhost\Service\AllowUnencrypted -Value $true

# 5Ô∏è‚É£ Allow blank passwords in Windows security policy
Set-ItemProperty -Path "HKLM:\SYSTEM\CurrentControlSet\Control\Lsa" `
-Name "limitblankpassworduse" -Value 0

# 6Ô∏è‚É£ Restart WinRM to apply changes
Restart-Service WinRM

# 7Ô∏è‚É£ Add user to Remote Management group
Add-LocalGroupMember -Group "Remote Management Users" -Member "work station" -ErrorAction SilentlyContinue
Add-LocalGroupMember -Group "Remote Management Users" -Member "desktop-c4nru4a\work station" -ErrorAction SilentlyContinue

# 8Ô∏è‚É£ Confirm listener exists
winrm enumerate winrm/config/listener

Write-Host "‚úÖ TARGET PC IS READY FOR NO-PASSWORD REMOTING!" -ForegroundColor Green
